USE SecurityCrawlerDatabase
GO

CREATE PROCEDURE dbo.addVulnerability
	@crawlID int,
	@details varchar(600)
AS
IF @crawlID IS NULL
BEGIN
	RAISERROR('crawlID cannot be null when adding Vulnerability', 14, 1);
	RETURN
END
IF @details IS NULL
BEGIN
	RAISERROR('Vulnerability requires a description to be added', 14, 2);
	RETURN
END
DECLARE @newVulnID int;
SET @newVulnID = (SELECT MAX(VulnerabilityID) FROM Vulnerability) + 1;
INSERT INTO Vulnerability(CrawlID, VulnerabilityID, Details)
VALUES(@crawlID, @newVulnID, @details)